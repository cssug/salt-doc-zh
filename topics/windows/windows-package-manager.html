<!DOCTYPE html>







<html>
    <head>
        <meta charset="utf-8">
        
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Windows软件仓库</title>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-site-verification" content="1Y-ojT3ndjxA9coB77iUDyXPWxeuQ3T4_r0j-QG6QHg" />

        
        <link rel="stylesheet" href="../../_static/css/core.min.css">
        <link rel="stylesheet" href="../../_static/css/webhelp.min_v1.4.4.css">
            <link rel="shortcut icon" href="../../_static/favicon.ico">

        <!--[if lt IE 9]>
        <script src="../../_static/js/respond.min.js"></script>
        <![endif]-->
        <link rel="top" title="" href="../../index.html">
        <link rel="up" title="Windows" href="index.html">
        <link rel="next" title="Windows-specific Behaviour" href="windows-specific-behavior.html">
        <link rel="prev" title="Windows" href="index.html">
    </head>

    <body class="index">
        <!--[if lt IE 8]>
            <p>You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser.</a></p>
        <![endif]-->
        <div id="wrapper">
            <div id="page-content-wrapper">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-12 col-md-11 col-md-offset-1 col-lg-10 col-lg-offset-1">
                            <!--start navbar-->
                            <nav class="navbar navbar-default">
                                <div class="navbar-header">
                                    <button type="button" class="pull-left navbar-toggle collapsed" id="menu-toggle"><span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                    </button>
                                    <ul id="header-nav" class="nav navbar-nav">
        <li>
            <a href="../../contents.html" title="Table of Contents">Table of Contents</a>
            
        </li>
        <li>
            <a href="../../glossary.html" title="Glossary">Glossary</a>
            
        </li>
        <li>
            <a href="index.html" title="Windows">上一页</a>
            
        </li>
        <li>
            <a href="windows-specific-behavior.html" title="Windows-specific Behaviour">下一页</a>
            
        </li>
        <li>
            <a href="../../salt-modindex.html" title="Salt Module Index">all salt modules</a>
            
        </li>
        <li>
            <a href="../../genindex.html" title="总目录">索引</a>
            
        </li> 

                                        

                                        
                                    </ul>
                                </div>
                            </nav>
                            <!--end navbar-->

                            

                            

                            
                            <div class="body-content">
                                
  <div class="section" id="windows-software-repository">
<span id="windows-package-manager"></span><h1>Windows软件仓库<a class="headerlink" href="#windows-software-repository" title="永久链接至标题">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">In 2015.8.0 and later, the Windows Software Repository cache is compiled on
the Salt Minion, which enables pillar, grains and other things to be
available during compilation time. To support this new functionality,
a next-generation (ng) package repository was created. See See the
<a class="reference internal" href="#winrepo-changes"><span>Changes in Version 2015.8.0</span></a> for details.</p>
</div>
<p>The SaltStack Windows Software Repository provides a package manager and software
repository similar to what is provided by yum and apt on Linux. This repository
enables the installation of software using the installers on remote Windows
systems.</p>
<p>In many senses, the operation is similar to that of
the other package managers salt is aware of:</p>
<ul class="simple">
<li><p class="first"><code class="docutils literal"><span class="pre">pkg.installed</span></code> 及类似的配置管理可以在Windows上运行.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">pkg.install</span></code> 及类似的模块函数能在Windows上运行.</p>
</li>
</ul>
<p>与yum和apt不同之处:</p>
<ul class="simple">
<li>The repository metadata (SLS files) is hosted through either salt or
git.</li>
<li><p class="first">软件包可以从salt仓库, git仓库, http(s)或ftp中进行下载.</p>
</li>
<li><p class="first">不管理依赖性. 包之间的依赖性需要手动管理.</p>
</li>
</ul>
<p>Requirements:</p>
<ul class="simple">
<li>GitPython 0.3 or later, or pygit2 0.20.3 with libgit 0.20.0 or later installed
on your Salt master. The Windows package definitions are downloaded
and updated using Git.</li>
</ul>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="永久链接至标题">¶</a></h2>
<div class="section" id="populate-the-repository">
<h3>Populate the Repository<a class="headerlink" href="#populate-the-repository" title="永久链接至标题">¶</a></h3>
<p>The SLS files used to install Windows packages are not distributed by default with
Salt. Run the following command to initialize the repository on your Salt
master:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt-run winrepo.update_git_repos
</pre></div>
</div>
</div>
<div class="section" id="sync-repo-to-windows-minions">
<h3>Sync Repo to Windows Minions<a class="headerlink" href="#sync-repo-to-windows-minions" title="永久链接至标题">¶</a></h3>
<p>Run <code class="docutils literal"><span class="pre">pkg.refresh_db</span></code> on each of your Windows minions to synchronize
the package repository.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt -G <span class="s1">&#39;os:windows&#39;</span> pkg.refresh_db
</pre></div>
</div>
</div>
</div>
<div class="section" id="install-windows-software">
<h2>安装Windows软件<a class="headerlink" href="#install-windows-software" title="永久链接至标题">¶</a></h2>
<p>After completing the configuration steps, you are ready to manage software on your
Windows minions.</p>
<div class="section" id="show-installed-packages">
<h3>Show Installed Packages<a class="headerlink" href="#show-installed-packages" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt -G <span class="s1">&#39;os:windows&#39;</span> pkg.list_pkgs
</pre></div>
</div>
</div>
<div class="section" id="install-a-package">
<h3>Install a Package<a class="headerlink" href="#install-a-package" title="永久链接至标题">¶</a></h3>
<p>You can query the available version of a package using the Salt pkg module.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt winminion pkg.available_version firefox

<span class="o">{</span><span class="s1">&#39;firefox&#39;</span>: <span class="o">{</span><span class="s1">&#39;15.0.1&#39;</span>: <span class="s1">&#39;Mozilla Firefox 15.0.1 (x86 en-US)&#39;</span>,
             <span class="s1">&#39;16.0.2&#39;</span>: <span class="s1">&#39;Mozilla Firefox 16.0.2 (x86 en-US)&#39;</span>,
             <span class="s1">&#39;17.0.1&#39;</span>: <span class="s1">&#39;Mozilla Firefox 17.0.1 (x86 en-US)&#39;</span><span class="o">}}</span>
</pre></div>
</div>
<p>正如你所看到的，有三个版本的Firefox可安装。你可以引用一个软件包通过它的 <code class="docutils literal"><span class="pre">name</span></code> 或者 <code class="docutils literal"><span class="pre">full_name</span></code> 用单引号引起来。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt winminion pkg.install <span class="s1">&#39;firefox&#39;</span>
</pre></div>
</div>
<p>上边的命令将会安装最新版本的Firefox.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt winminion pkg.install <span class="s1">&#39;firefox&#39;</span> <span class="nv">version</span><span class="o">=</span>16.0.2
</pre></div>
</div>
<p>上边的命令将会安装Firefox的16.0.2版本.</p>
<p>If a different version of the package is already installed it will be replaced
with the version in the winrepo (only if the package itself supports live
updating).</p>
<p>你可以同样指定完整名:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt winminion pkg.install <span class="s1">&#39;Mozilla Firefox 17.0.1 (x86 en-US)&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="uninstall-windows-software">
<h2>卸载Windows软件<a class="headerlink" href="#uninstall-windows-software" title="永久链接至标题">¶</a></h2>
<p>使用pkg模块卸载软件包:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt winminion pkg.remove firefox
salt winminion pkg.purge firefox
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last"><code class="docutils literal"><span class="pre">pkg.purge</span></code> 在Windows上只是执行 <code class="docutils literal"><span class="pre">pkg.remove</span></code>. 未来的 <code class="docutils literal"><span class="pre">pkg.purge</span></code> 可能会支持移除所有软件包的配置及设置选项.</p>
</div>
</div>
<div class="section" id="repository-location">
<h2>Repository Location<a class="headerlink" href="#repository-location" title="永久链接至标题">¶</a></h2>
<p>Salt maintains a repository of SLS files to install a large number of Windows
packages:</p>
<ul class="simple">
<li>2015.8.0 and later minions: <a class="reference external" href="https://github.com/saltstack/salt-winrepo-ng">https://github.com/saltstack/salt-winrepo-ng</a></li>
<li>Earlier releases: <a class="reference external" href="https://github.com/saltstack/salt-winrepo">https://github.com/saltstack/salt-winrepo</a></li>
</ul>
<p>By default, these repositories are mirrored to <code class="docutils literal"><span class="pre">/srv/salt/win/repo_ng</span></code>
and <code class="docutils literal"><span class="pre">/srv/salt/win/repo</span></code>.</p>
<p>This location can be changed in the master config file by setting the
<a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_dir_ng"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_dir_ng</span></code></a> and <a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_dir"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_dir</span></code></a> options.</p>
</div>
<div class="section" id="maintaining-windows-repo-definitions-in-git-repositories">
<h2>Maintaining Windows Repo Definitions in Git Repositories<a class="headerlink" href="#maintaining-windows-repo-definitions-in-git-repositories" title="永久链接至标题">¶</a></h2>
<p>Windows software package definitions can be hosted in one or more Git
repositories. The default repositories are hosted on GitHub by SaltStack. These
include software definition files for various open source software projects.
These software definition files are <code class="docutils literal"><span class="pre">.sls</span></code> files. There are two default
repositories: <code class="docutils literal"><span class="pre">salt-winrepo</span></code> and <code class="docutils literal"><span class="pre">salt-winrepo-ng</span></code>. <code class="docutils literal"><span class="pre">salt-winrepo</span></code>
contains software definition files for older minions (older than 2015.8.0).
<code class="docutils literal"><span class="pre">salt-winrepo-ng</span></code> is for newer minions (2015.8.0 and newer).</p>
<p>Each software definition file contains all the information salt needs to install
that software on a minion including the HTTP or FTP locations of the installer
files, required command-line switches for silent install, etc. Anyone is welcome
to send a pull request to this repo to add new package definitions. The repos
can be browsed here:
<a class="reference external" href="https://github.com/saltstack/salt-winrepo.git">salt-winrepo</a>
<a class="reference external" href="https://github.com/saltstack/salt-winrepo-ng.git">salt-winrepo-ng</a></p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The newer software definition files are run through the salt's parser which
allows for the use of jinja.</p>
</div>
<p>Configure which git repositories the master can search for package definitions
by modifying or extending the <a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_remotes"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_remotes</span></code></a> and
<a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_remotes_ng"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_remotes_ng</span></code></a> options.</p>
<div class="admonition important">
<p class="first admonition-title">重要</p>
<p class="last"><code class="docutils literal"><span class="pre">winrepo_remotes</span></code> was called <code class="docutils literal"><span class="pre">win_gitrepos</span></code> in Salt versions earlier
than 2015.8.0</p>
</div>
<p>Package definitions are pulled down from the online repository by running the
<a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-mod docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a> runner.
This command is run on the master:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt-run winrepo.update_git_repos
</pre></div>
</div>
<p>This will pull down the software definition files for older minions
(<code class="docutils literal"><span class="pre">salt-winrepo</span></code>) and new minions (<code class="docutils literal"><span class="pre">salt-winrepo-ng</span></code>). They are stored in the
<code class="docutils literal"><span class="pre">file_roots</span></code> under <code class="docutils literal"><span class="pre">win/repo/salt-winrepo</span></code> and
<code class="docutils literal"><span class="pre">win/repo-ng/salt-winrepo-ng</span></code> respectively.</p>
<div class="admonition important">
<p class="first admonition-title">重要</p>
<p>If you have customized software definition files that aren't maintained in a
repository, those should be stored under <code class="docutils literal"><span class="pre">win/repo</span></code> for older minions and
<code class="docutils literal"><span class="pre">win/repo-ng</span></code> for newer minions. The reason for this is that the contents
of <code class="docutils literal"><span class="pre">win/repo/salt-winrepo</span></code> and <code class="docutils literal"><span class="pre">win/repo-ng/salt-winrepo-ng</span></code> are wiped
out every time you run a <code class="docutils literal"><span class="pre">winrepo.update_git_repos</span></code>.</p>
<p class="last">Additionally, when you run <code class="docutils literal"><span class="pre">winrepo.genrepo</span></code> and <code class="docutils literal"><span class="pre">pkg.refresh_db</span></code> the
entire contents under <code class="docutils literal"><span class="pre">win/repo</span></code> and <code class="docutils literal"><span class="pre">win/repo-ng</span></code>, to include all
subdirectories, are used to create the msgpack file.</p>
</div>
<p>The next step (if you have older minions) is to create the msgpack file for the
repo (<code class="docutils literal"><span class="pre">winrepo.p</span></code>). This is done by running the
<a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.genrepo" title="salt.runners.winrepo.genrepo"><code class="xref py py-mod docutils literal"><span class="pre">winrepo.genrepo</span></code></a> runner. This is also run
on the master:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt-run winrepo.genrepo
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">If you have only 2015.8.0 and newer minions, you no longer need to run
<code class="docutils literal"><span class="pre">salt-run</span> <span class="pre">winrepo.genrepo</span></code> on the master.</p>
</div>
<p>Finally, you need to refresh the minion database by running the
<a class="reference internal" href="../../ref/modules/all/salt.modules.win_pkg.html#salt.modules.win_pkg.refresh_db" title="salt.modules.win_pkg.refresh_db"><code class="xref py py-func docutils literal"><span class="pre">pkg.refresh_db</span></code></a> command. This is run
on the master as well:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt <span class="s1">&#39;*&#39;</span> pkg.refresh_db
</pre></div>
</div>
<p>On older minions (older than 2015.8.0) this will copy the winrepo.p file down to
the minion. On newer minions (2015.8.0 and newer) this will copy all the
software definition files (.sls) down to the minion and then create the msgpack
file (<code class="docutils literal"><span class="pre">winrepo.p</span></code>) locally. The reason this is done locally is because the
jinja needs to be parsed using the minion's grains.</p>
<div class="admonition important">
<p class="first admonition-title">重要</p>
<p class="last">Every time you modify the software definition files on the master, either by
running <code class="docutils literal"><span class="pre">salt-run</span> <span class="pre">winrepo.update_git_repos</span></code>, modifying existing files, or
by creating your own, you need to refresh the database on your minions. For
older minions, that means running <code class="docutils literal"><span class="pre">salt-run</span> <span class="pre">winrepo.genrepo</span></code> and then
<code class="docutils literal"><span class="pre">salt</span> <span class="pre">'*'</span> <span class="pre">pkg.refresh_db</span></code>. For newer minions (2015.8.0 and newer) it is
just <code class="docutils literal"><span class="pre">salt</span> <span class="pre">'*'</span> <span class="pre">pkg.refresh_db</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">If the <code class="docutils literal"><span class="pre">winrepo.genrepo</span></code> or the <code class="docutils literal"><span class="pre">pkg.refresh_db</span></code> fails, it is likely a
problem with the jinja in one of the software definition files. This will
cause the operations to stop. You'll need to fix the syntax in order for the
msgpack file to be created successfully.</p>
</div>
</div>
<div class="section" id="creating-a-package-definition-sls-file">
<h2>Creating a Package Definition SLS File<a class="headerlink" href="#creating-a-package-definition-sls-file" title="永久链接至标题">¶</a></h2>
<p>The package definition file is a yaml file that contains all the information
needed to install a piece of software using salt. It defines information about
the package to include version, full name, flags required for the installer and
uninstaller, whether or not to use the windows task scheduler to install the
package, where to find the installation package, etc.</p>
<p>Take a look at this example for Firefox:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">firefox</span><span class="p p-Indicator">:</span>
  <span class="s">&#39;17.0.1&#39;</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">installer</span><span class="p p-Indicator">:</span> <span class="s">&#39;salt://win/repo/firefox/English/Firefox</span><span class="nv"> </span><span class="s">Setup</span><span class="nv"> </span><span class="s">17.0.1.exe&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">full_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Mozilla Firefox 17.0.1 (x86 en-US)</span>
    <span class="l l-Scalar l-Scalar-Plain">locale</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">en_US</span>
    <span class="l l-Scalar l-Scalar-Plain">reboot</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
    <span class="l l-Scalar l-Scalar-Plain">install_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;-ms&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstaller</span><span class="p p-Indicator">:</span> <span class="s">&#39;%ProgramFiles(x86)%/Mozilla</span><span class="nv"> </span><span class="s">Firefox/uninstall/helper.exe&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstall_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/S&#39;</span>
  <span class="s">&#39;16.0.2&#39;</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">installer</span><span class="p p-Indicator">:</span> <span class="s">&#39;salt://win/repo/firefox/English/Firefox</span><span class="nv"> </span><span class="s">Setup</span><span class="nv"> </span><span class="s">16.0.2.exe&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">full_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Mozilla Firefox 16.0.2 (x86 en-US)</span>
    <span class="l l-Scalar l-Scalar-Plain">locale</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">en_US</span>
    <span class="l l-Scalar l-Scalar-Plain">reboot</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
    <span class="l l-Scalar l-Scalar-Plain">install_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;-ms&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstaller</span><span class="p p-Indicator">:</span> <span class="s">&#39;%ProgramFiles(x86)%/Mozilla</span><span class="nv"> </span><span class="s">Firefox/uninstall/helper.exe&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstall_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/S&#39;</span>
  <span class="s">&#39;15.0.1&#39;</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">installer</span><span class="p p-Indicator">:</span> <span class="s">&#39;salt://win/repo/firefox/English/Firefox</span><span class="nv"> </span><span class="s">Setup</span><span class="nv"> </span><span class="s">15.0.1.exe&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">full_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Mozilla Firefox 15.0.1 (x86 en-US)</span>
    <span class="l l-Scalar l-Scalar-Plain">locale</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">en_US</span>
    <span class="l l-Scalar l-Scalar-Plain">reboot</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
    <span class="l l-Scalar l-Scalar-Plain">install_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;-ms&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstaller</span><span class="p p-Indicator">:</span> <span class="s">&#39;%ProgramFiles(x86)%/Mozilla</span><span class="nv"> </span><span class="s">Firefox/uninstall/helper.exe&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstall_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/S&#39;</span>
</pre></div>
</div>
<p>Each software definition file begins with a package name for the software. As in
the example above <code class="docutils literal"><span class="pre">firefox</span></code>. The next line is indented two spaces and contains
the version to be defined. As in the example above, a software definition file
can define multiple versions for the same piece of software. The lines following
the version are indented two more spaces and contain all the information needed
to install that package.</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">The package name and the <code class="docutils literal"><span class="pre">full_name</span></code> must be unique to all
other packages in the software repository.</p>
</div>
<p>The version line is the version for the package to be installed. It is used when
you need to install a specific version of a piece of software.</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">The version must be enclosed in quotes, otherwise the yaml parser
will remove trailing zeros.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">There are unique situations where previous versions are unavailable.
Take Google Chrome for example. There is only one url provided for a
standalone installation of Google Chrome.
(<a class="reference external" href="https://dl.google.com/edgedl/chrome/install/GoogleChromeStandaloneEnterprise.msi">https://dl.google.com/edgedl/chrome/install/GoogleChromeStandaloneEnterprise.msi</a>)
When a new version is released, the url just points to the new version. To
handle situations such as these, set the version to <cite>latest</cite>. Salt will
install the version of Chrome at the URL and report that version. Here's an
example:</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>chrome:
  latest:
    full_name: <span class="s1">&#39;Google Chrome&#39;</span>
    installer: <span class="s1">&#39;https://dl.google.com/edgedl/chrome/install/GoogleChromeStandaloneEnterprise.msi&#39;</span>
    install_flags: <span class="s1">&#39;/qn /norestart&#39;</span>
    uninstaller: <span class="s1">&#39;https://dl.google.com/edgedl/chrome/install/GoogleChromeStandaloneEnterprise.msi&#39;</span>
    uninstall_flags: <span class="s1">&#39;/qn /norestart&#39;</span>
    msiexec: True
    locale: en_US
    reboot: False
</pre></div>
</div>
<p>Available parameters are as follows:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param str full_name:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">The Full Name for the software as shown in &quot;Programs and
Features&quot; in the control panel. You can also get this information by
installing the package manually and then running <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code>. Here's
an example of the output from <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code>:</td>
</tr>
</tbody>
</table>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt <span class="s1">&#39;test-2008&#39;</span> pkg.list_pkgs
test-2008
    ----------
    7-Zip 9.20 <span class="o">(</span>x64 edition<span class="o">)</span>:
        9.20.00.0
    Microsoft .NET Framework <span class="m">4</span> Client Profile:
        4.0.30319,4.0.30319
    Microsoft .NET Framework <span class="m">4</span> Extended:
        4.0.30319,4.0.30319
    Microsoft Visual C++ <span class="m">2008</span> Redistributable - x64 9.0.21022:
        9.0.21022
    Mozilla Firefox 17.0.1 <span class="o">(</span>x86 en-US<span class="o">)</span>:
        17.0.1
    Mozilla Maintenance Service:
        17.0.1
    NSClient++ <span class="o">(</span>x64<span class="o">)</span>:
        0.3.8.76
    Notepad++:
        6.4.2
    Salt Minion 0.16.0:
        0.16.0
</pre></div>
</div>
<p>Notice the Full Name for Firefox: Mozilla Firefox 17.0.0 (x86 en-US). That's
exactly what's in the <code class="docutils literal"><span class="pre">full_name</span></code> parameter in the software definition file.</p>
<p>If any of the software insalled on the machine matches one of the software
definition files in the repository the full_name will be automatically renamed
to the package name. The example below shows the <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code> for a
machine that already has Mozilla Firefox 17.0.1 installed.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>test-2008:
    ----------
    7zip:
        9.20.00.0
    Microsoft .NET Framework <span class="m">4</span> Client Profile:
        4.0.30319,4.0.30319
    Microsoft .NET Framework <span class="m">4</span> Extended:
        4.0.30319,4.0.30319
    Microsoft Visual C++ <span class="m">2008</span> Redistributable - x64 9.0.21022:
        9.0.21022
    Mozilla Maintenance Service:
        17.0.1
    Notepad++:
        6.4.2
    Salt Minion 0.16.0:
        0.16.0
    firefox:
        17.0.1
    nsclient:
        0.3.9.328
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">重要</p>
<p class="last">The version number and <code class="docutils literal"><span class="pre">full_name</span></code> need to match the output
from <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code> so that the status can be verified when running
highstate.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">It is still possible to successfully install packages using
<code class="docutils literal"><span class="pre">pkg.install</span></code> even if they don't match. This can make troubleshooting
difficult so be careful.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param str installer:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">The path to the <code class="docutils literal"><span class="pre">.exe</span></code> or <code class="docutils literal"><span class="pre">.msi</span></code> to use to install the
package. This can be a path or a URL. If it is a URL or a salt path
(salt://), the package will be cached locally and then executed. If it is a
path to a file on disk or a file share, it will be executed directly.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param str install_flags:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">Any flags that need to be passed to the installer to
make it perform a silent install. These can often be found by adding <code class="docutils literal"><span class="pre">/?</span></code>
or <code class="docutils literal"><span class="pre">/h</span></code> when running the installer from the command-line. A great resource
for finding these silent install flags can be found on the WPKG project's <a class="reference external" href="http://wpkg.org/Category:Silent_Installers">wiki</a>:</td>
</tr>
</tbody>
</table>
<p>Salt will not return if the installer is waiting for user input so these are
important.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param str uninstaller:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><p class="first">The path to the program used to uninstall this software.
This can be the path to the same <cite>exe</cite> or <cite>msi</cite> used to install the
software. It can also be a GUID. You can find this value in the registry
under the following keys:</p>
<ul class="simple">
<li>Software\Microsoft\Windows\CurrentVersion\Uninstall</li>
<li>Software\Wow6432None\Microsoft\Windows\CurrentVersion\Uninstall</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param str uninstall_flags:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">Any flags that need to be passed to the uninstaller
to make it perform a silent uninstall. These can often be found by adding
<code class="docutils literal"><span class="pre">/?</span></code> or <code class="docutils literal"><span class="pre">/h</span></code> when running the uninstaller from the command-line. A great
resource for finding these silent install flags can be found on the WPKG
project's <a class="reference external" href="http://wpkg.org/Category:Silent_Installers">wiki</a>:</p>
</td>
</tr>
</tbody>
</table>
<p>Salt will not return if the uninstaller is waiting for user input so these are
important.</p>
<p>Here are some examples of installer and uninstaller settings:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">7zip</span><span class="p p-Indicator">:</span>
  <span class="s">&#39;9.20.00.0&#39;</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">installer</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">salt://win/repo/7zip/7z920-x64.msi</span>
    <span class="l l-Scalar l-Scalar-Plain">full_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">7-Zip 9.20 (x64 edition)</span>
    <span class="l l-Scalar l-Scalar-Plain">reboot</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
    <span class="l l-Scalar l-Scalar-Plain">install_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/qn</span><span class="nv"> </span><span class="s">/norestart&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">msiexec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstaller</span><span class="p p-Indicator">:</span> <span class="s">&#39;{23170F69-40C1-2702-0920-000001000000}&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstall_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/qn</span><span class="nv"> </span><span class="s">/norestart&#39;</span>
</pre></div>
</div>
<p>Alternatively the <code class="docutils literal"><span class="pre">uninstaller</span></code> can also simply repeat the URL of the msi file.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">7zip</span><span class="p p-Indicator">:</span>
  <span class="s">&#39;9.20.00.0&#39;</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">installer</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">salt://win/repo/7zip/7z920-x64.msi</span>
    <span class="l l-Scalar l-Scalar-Plain">full_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">7-Zip 9.20 (x64 edition)</span>
    <span class="l l-Scalar l-Scalar-Plain">reboot</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
    <span class="l l-Scalar l-Scalar-Plain">install_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/qn</span><span class="nv"> </span><span class="s">/norestart&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">msiexec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstaller</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">salt://win/repo/7zip/7z920-x64.msi</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstall_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/qn</span><span class="nv"> </span><span class="s">/norestart&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param bool msiexec:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">This tells salt to use <code class="docutils literal"><span class="pre">msiexec</span> <span class="pre">/i</span></code> to install the
package and <code class="docutils literal"><span class="pre">msiexec</span> <span class="pre">/x</span></code> to uninstall. This is for <cite>.msi</cite> installations.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param bool allusers:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">This parameter is specific to <cite>.msi</cite> installations. It
tells <cite>msiexec</cite> to install the software for all users. The default is True.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param bool cache_dir:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">If true, the entire directory where the installer resides
will be recursively cached. This is useful for installers that depend on
other files in the same directory for installation.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Only applies to salt: installer URLs.</p>
</div>
<p>Here's an example for a software package that has dependent files:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">sqlexpress</span><span class="p p-Indicator">:</span>
  <span class="s">&#39;12.0.2000.8&#39;</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">installer</span><span class="p p-Indicator">:</span> <span class="s">&#39;salt://win/repo/sqlexpress/setup.exe&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">full_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Microsoft SQL Server 2014 Setup (English)</span>
    <span class="l l-Scalar l-Scalar-Plain">reboot</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
    <span class="l l-Scalar l-Scalar-Plain">install_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/ACTION=install</span><span class="nv"> </span><span class="s">/IACCEPTSQLSERVERLICENSETERMS</span><span class="nv"> </span><span class="s">/Q&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">cache_dir</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param bool use_scheduler:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">If true, windows will use the task scheduler to run
the installation. This is useful for running the salt installation itself as
the installation process kills any currently running instances of salt.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param str source_hash:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">This tells salt to compare a hash sum of the installer</td>
</tr>
</tbody>
</table>
<p>to the provided hash sum before execution. The value can be formatted as
<code class="docutils literal"><span class="pre">hash_algorithm=hash_sum</span></code>, or it can be a URI to a file containing the hash
sum.
For a list of supported algorithms, see the <a class="reference external" href="https://docs.python.org/2/library/hashlib.html">hashlib documentation</a>.</p>
<p>Here's an example of source_hash usage:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">messageanalyzer</span><span class="p p-Indicator">:</span>
  <span class="s">&#39;4.0.7551.0&#39;</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">full_name</span><span class="p p-Indicator">:</span> <span class="s">&#39;Microsoft</span><span class="nv"> </span><span class="s">Message</span><span class="nv"> </span><span class="s">Analyzer&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">installer</span><span class="p p-Indicator">:</span> <span class="s">&#39;salt://win/repo/messageanalyzer/MessageAnalyzer64.msi&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">install_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/quiet</span><span class="nv"> </span><span class="s">/norestart&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstaller</span><span class="p p-Indicator">:</span> <span class="s">&#39;{1CC02C23-8FCD-487E-860C-311EC0A0C933}&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">uninstall_flags</span><span class="p p-Indicator">:</span> <span class="s">&#39;/quiet</span><span class="nv"> </span><span class="s">/norestart&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">msiexec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
    <span class="l l-Scalar l-Scalar-Plain">source_hash</span><span class="p p-Indicator">:</span> <span class="s">&#39;sha1=62875ff451f13b10a8ff988f2943e76a4735d3d4&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param bool reboot:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Not implemented</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param str local:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">Not implemented</td>
</tr>
</tbody>
</table>
<p>Examples can be found at <a class="reference external" href="https://github.com/saltstack/salt-winrepo-ng">https://github.com/saltstack/salt-winrepo-ng</a></p>
</div>
<div class="section" id="managing-windows-software-on-a-standalone-windows-minion">
<span id="standalone-winrepo"></span><h2>Managing Windows Software on a Standalone Windows Minion<a class="headerlink" href="#managing-windows-software-on-a-standalone-windows-minion" title="永久链接至标题">¶</a></h2>
<p>The Windows Package Repository functions similar in a standalone environment,
with a few differences in the configuration.</p>
<p>To replace the winrepo runner that is used on the Salt master, an <a class="reference internal" href="../../ref/modules/all/salt.modules.win_repo.html#module-salt.modules.win_repo" title="salt.modules.win_repo"><code class="xref py py-mod docutils literal"><span class="pre">execution</span> <span class="pre">module</span></code></a> exists to provide the same functionality to standalone
minions. The functions are named the same as the ones in the runner, and are
used in the same way; the only difference is that <code class="docutils literal"><span class="pre">salt-call</span></code> is used instead
of <code class="docutils literal"><span class="pre">salt-run</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt-call winrepo.update_git_repos
salt-call winrepo.genrepo
salt-call pkg.refresh_db
</pre></div>
</div>
<p>After executing the previous commands the repository on the standalone system
is ready to use.</p>
<div class="section" id="custom-location-for-repository-sls-files">
<h3>Custom Location for Repository SLS Files<a class="headerlink" href="#custom-location-for-repository-sls-files" title="永久链接至标题">¶</a></h3>
<p>If <a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-file_roots"><code class="xref std std-conf_minion docutils literal"><span class="pre">file_roots</span></code></a> has not been modified in the minion
configuration, then no additional configuration needs to be added to the
minion configuration. The <a class="reference internal" href="../../ref/modules/all/salt.modules.win_repo.html#salt.modules.win_repo.genrepo" title="salt.modules.win_repo.genrepo"><code class="xref py py-func docutils literal"><span class="pre">winrepo.genrepo</span></code></a> function from the <a class="reference internal" href="../../ref/modules/all/salt.modules.win_repo.html#module-salt.modules.win_repo" title="salt.modules.win_repo"><code class="xref py py-mod docutils literal"><span class="pre">winrepo</span></code></a> execution module will by default look for the
filename specified by <a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-winrepo_cachefile"><code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_cachefile</span></code></a> within
<code class="docutils literal"><span class="pre">C:\salt\srv\salt\win\repo</span></code>.</p>
<p>If the <a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-file_roots"><code class="xref std std-conf_minion docutils literal"><span class="pre">file_roots</span></code></a> parameter has been modified, then
<a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-winrepo_dir"><code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_dir</span></code></a> must be modified to fall within that path, at the
proper relative path. For example, if the <code class="docutils literal"><span class="pre">base</span></code> environment in
<a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-file_roots"><code class="xref std std-conf_minion docutils literal"><span class="pre">file_roots</span></code></a> points to <code class="docutils literal"><span class="pre">D:\foo</span></code>, and
<code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_source_dir</span></code> is <code class="docutils literal"><span class="pre">salt://win/repo</span></code>, then
<a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-winrepo_dir"><code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_dir</span></code></a> must be set to <code class="docutils literal"><span class="pre">D:\foo\win\repo</span></code> to ensure that
<a class="reference internal" href="../../ref/modules/all/salt.modules.win_repo.html#salt.modules.win_repo.genrepo" title="salt.modules.win_repo.genrepo"><code class="xref py py-func docutils literal"><span class="pre">winrepo.genrepo</span></code></a> puts the cachefile
into right location.</p>
</div>
</div>
<div class="section" id="config-options-for-minions-2015-8-0-and-later">
<h2>Config Options for Minions 2015.8.0 and Later<a class="headerlink" href="#config-options-for-minions-2015-8-0-and-later" title="永久链接至标题">¶</a></h2>
<p>The <code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_source_dir</span></code> config parameter (default:
<code class="docutils literal"><span class="pre">salt://win/repo</span></code>) controls where <a class="reference internal" href="../../ref/modules/all/salt.modules.win_pkg.html#salt.modules.win_pkg.refresh_db" title="salt.modules.win_pkg.refresh_db"><code class="xref py py-mod docutils literal"><span class="pre">pkg.refresh_db</span></code></a> looks for the cachefile (default:
<code class="docutils literal"><span class="pre">winrepo.p</span></code>). This means that the default location for the winrepo cachefile
would be <code class="docutils literal"><span class="pre">salt://win/repo/winrepo.p</span></code>. Both <code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_source_dir</span></code>
and <a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-winrepo_cachefile"><code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_cachefile</span></code></a> can be adjusted to match the actual
location of this file on the Salt fileserver.</p>
</div>
<div class="section" id="config-options-for-minions-before-2015-8-0">
<h2>Config Options for Minions Before 2015.8.0<a class="headerlink" href="#config-options-for-minions-before-2015-8-0" title="永久链接至标题">¶</a></h2>
<p>If connected to a master, the minion will by default look for the winrepo
cachefile (the file generated by the <a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.genrepo" title="salt.runners.winrepo.genrepo"><code class="xref py py-mod docutils literal"><span class="pre">winrepo.genrepo</span> <span class="pre">runner</span></code></a>) at <code class="docutils literal"><span class="pre">salt://win/repo/winrepo.p</span></code>. If the
cachefile is in a different path on the salt fileserver, then
<a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-win_repo_cachefile"><code class="xref std std-conf_minion docutils literal"><span class="pre">win_repo_cachefile</span></code></a> will need to be updated to reflect the proper
location.</p>
</div>
<div class="section" id="changes-in-version-2015-8-0">
<span id="winrepo-changes"></span><h2>Changes in Version 2015.8.0<a class="headerlink" href="#changes-in-version-2015-8-0" title="永久链接至标题">¶</a></h2>
<p>Git repository management for the Windows Software Repository has changed
in version 2015.8.0, and several master/minion config parameters have been
renamed to make their naming more consistent with each other.</p>
<p>For a list of the winrepo config options, see <a class="reference internal" href="../../ref/configuration/master.html#winrepo-master-config-opts"><span>here</span></a> for master config options, and <a class="reference internal" href="../../ref/configuration/minion.html#winrepo-minion-config-opts"><span>here</span></a> for configuration options for masterless Windows
minions.</p>
<p>On the master, the <a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-mod docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a> runner has been updated to use either
<a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a> or <a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> to checkout the git repositories containing repo data. If
<a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a> or <a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> is installed, existing winrepo git checkouts should be
removed after upgrading to 2015.8.0, to allow them to be checked out again by
running <a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-func docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a>.</p>
<p>If neither <a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> nor <a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a> are installed, then Salt will fall back to
the pre-existing behavior for <a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-mod docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a>, and a warning will be logged in the
master log.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Standalone Windows minions do not support the new <a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a>/<a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a>
functionality, and will instead use the <a class="reference internal" href="../../ref/states/all/salt.states.git.html#salt.states.git.latest" title="salt.states.git.latest"><code class="xref py py-func docutils literal"><span class="pre">git.latest</span></code></a> state to keep repositories up-to-date. More
information on how to use the Windows Software Repo on a standalone minion
can be found <a class="reference internal" href="#standalone-winrepo"><span>here</span></a>.</p>
</div>
<div class="section" id="config-parameters-renamed">
<h3>Config Parameters Renamed<a class="headerlink" href="#config-parameters-renamed" title="永久链接至标题">¶</a></h3>
<p>Many of the legacy winrepo configuration parameters have changed in version 2015.8.0
to make the naming more consistent. The old parameter names will still work,
but a warning will be logged indicating that the old name is deprecated.</p>
<p>Below are the parameters which have changed for version 2015.8.0:</p>
<div class="section" id="master-config">
<h4>Master Config<a class="headerlink" href="#master-config" title="永久链接至标题">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Old Name</th>
<th class="head">New Name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>win_repo</td>
<td><a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_dir"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_dir</span></code></a></td>
</tr>
<tr class="row-odd"><td>win_repo_mastercachefile</td>
<td><a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_cachefile"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_cachefile</span></code></a></td>
</tr>
<tr class="row-even"><td>win_gitrepos</td>
<td><a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_remotes"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_remotes</span></code></a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last"><code class="docutils literal"><span class="pre">winrepo_cachefile</span></code> is no longer used by 2015.8.0 and later minions, and
the <code class="docutils literal"><span class="pre">winrepo_dir</span></code> setting is replaced by <code class="docutils literal"><span class="pre">winrepo_dir_ng</span></code> for 2015.8.0
and later minions.</p>
</div>
<p>See <a class="reference internal" href="../../ref/configuration/master.html#winrepo-master-config-opts"><span>here</span></a> for detailed information on all
master config options for the Windows Repo.</p>
</div>
<div class="section" id="minion-config">
<h4>Minion Config<a class="headerlink" href="#minion-config" title="永久链接至标题">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Old Name</th>
<th class="head">New Name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>win_repo</td>
<td><a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-winrepo_dir"><code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_dir</span></code></a></td>
</tr>
<tr class="row-odd"><td>win_repo_cachefile</td>
<td><a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-winrepo_cachefile"><code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_cachefile</span></code></a></td>
</tr>
<tr class="row-even"><td>win_gitrepos</td>
<td><a class="reference internal" href="../../ref/configuration/minion.html#std:conf_minion-winrepo_remotes"><code class="xref std std-conf_minion docutils literal"><span class="pre">winrepo_remotes</span></code></a></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="../../ref/configuration/minion.html#winrepo-minion-config-opts"><span>here</span></a> for detailed information on all
minion config options for the Windows Repo.</p>
</div>
</div>
<div class="section" id="pygit2-gitpython-support-for-maintaining-git-repos">
<h3><a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a>/<a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> Support for Maintaining Git Repos<a class="headerlink" href="#pygit2-gitpython-support-for-maintaining-git-repos" title="永久链接至标题">¶</a></h3>
<p>The <a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-func docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a>
runner (and the corresponding <a class="reference internal" href="../../ref/modules/all/salt.modules.win_repo.html#salt.modules.win_repo.update_git_repos" title="salt.modules.win_repo.update_git_repos"><code class="xref py py-func docutils literal"><span class="pre">remote</span> <span class="pre">execution</span> <span class="pre">function</span></code></a> for standalone minions) now makes use
of the same underlying code used by the <a class="reference internal" href="../tutorials/gitfs.html#tutorial-gitfs"><span>Git Fileserver Backend</span></a> and <a class="reference internal" href="../../ref/pillar/all/salt.pillar.git_pillar.html#module-salt.pillar.git_pillar" title="salt.pillar.git_pillar"><code class="xref py py-mod docutils literal"><span class="pre">Git</span> <span class="pre">External</span> <span class="pre">Pillar</span></code></a> to
maintain and update its local clones of git repositories. If a compatible
version of either <a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a> (0.20.3 and later) or <a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> (0.3.0 or later) is
installed, then Salt will use it instead of the old method (which invokes the
<a class="reference internal" href="../../ref/states/all/salt.states.git.html#salt.states.git.latest" title="salt.states.git.latest"><code class="xref py py-func docutils literal"><span class="pre">git.latest</span></code></a> state).</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>If compatible versions of both <a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a> and <a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> are installed, then
Salt will prefer <a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a>, to override this behavior use the
<a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_provider"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_provider</span></code></a> configuration parameter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">winrepo_provider</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">gitpython</span>
</pre></div>
</div>
<p class="last">The <a class="reference internal" href="../../ref/modules/all/salt.modules.win_repo.html#module-salt.modules.win_repo" title="salt.modules.win_repo"><code class="xref py py-mod docutils literal"><span class="pre">winrepo</span> <span class="pre">execution</span> <span class="pre">module</span></code></a> (discussed
above in the <a class="reference internal" href="#standalone-winrepo"><span>Managing Windows Software on a Standalone Windows Minion</span></a> section) does not yet officially support the new
<a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a>/<a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> functionality, but if either <a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a> or <a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a> is
installed into Salt's bundled Python then it <em>should</em> work. However, it
should be considered experimental at this time.</p>
</div>
<p>To minimize potential issues, it is a good idea to remove any winrepo git
repositories that were checked out by the old (pre-2015.8.0) winrepo code when
upgrading the master to 2015.8.0 or later, and run
<a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-func docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a> to
clone them anew after the master is started.</p>
<p>Additional added features include the ability to access authenticated git
repositories (<strong>NOTE:</strong> <a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a> only), and to set per-remote config settings.
An example of this would be the following:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">winrepo_remotes</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/saltstack/salt-winrepo.git</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git@github.com:myuser/myrepo.git</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pubkey</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/key.pub</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">privkey</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/key</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">passphrase</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">myaw3s0m3pa$$phr4$3</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/myuser/privaterepo.git</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mygithubuser</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">CorrectHorseBatteryStaple</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>Per-remote configuration settings work in the same fashion as they do in
gitfs, with global parameters being overridden by their per-remote
counterparts (for instance, setting <a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_passphrase"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_passphrase</span></code></a> would
set a global passphrase for winrepo that would apply to all SSH-based
remotes, unless overridden by a <code class="docutils literal"><span class="pre">passphrase</span></code> per-remote parameter).</p>
<p class="last">See <a class="reference internal" href="../tutorials/gitfs.html#gitfs-per-remote-config"><span>here</span></a> for more a more in-depth
explanation of how per-remote configuration works in gitfs, the same
principles apply to winrepo.</p>
</div>
<p>There are a couple other changes in how Salt manages git repos using
<a class="reference external" href="https://github.com/libgit2/pygit2">pygit2</a>/<a class="reference external" href="https://github.com/gitpython-developers/GitPython">GitPython</a>. First of all, a <code class="docutils literal"><span class="pre">clean</span></code> argument has been added to the
<a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-func docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a>
runner, which (if set to <code class="docutils literal"><span class="pre">True</span></code>) will tell the runner to dispose of
directories under the <a class="reference internal" href="../../ref/configuration/master.html#std:conf_master-winrepo_dir"><code class="xref std std-conf_master docutils literal"><span class="pre">winrepo_dir</span></code></a> which are not explicitly
configured. This prevents the need to manually remove these directories when a
repo is removed from the config file. To clean these old directories, just pass
<code class="docutils literal"><span class="pre">clean=True</span></code>, like so:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt-run winrepo.update_git_repos <span class="nv">clean</span><span class="o">=</span>True
</pre></div>
</div>
<p>However, if a mix of git and non-git Windows Repo definition files are being
used, then this should <em>not</em> be used, as it will remove the directories
containing non-git definitions.</p>
<p>The other major change is that collisions between repo names are now detected,
and the <a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-func docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a> runner will not proceed if any are
detected. Consider the following configuration:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">winrepo_remotes</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://foo.com/bar/baz.git</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://mydomain.tld/baz.git</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/foobar/baz</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../ref/runners/all/salt.runners.winrepo.html#salt.runners.winrepo.update_git_repos" title="salt.runners.winrepo.update_git_repos"><code class="xref py py-func docutils literal"><span class="pre">winrepo.update_git_repos</span></code></a>
runner will refuse to update repos here, as all three of these repos would be
checked out to the same directory. To work around this, a per-remote parameter
called <code class="docutils literal"><span class="pre">name</span></code> can be used to resolve these conflicts:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">winrepo_remotes</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://foo.com/bar/baz.git</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://mydomain.tld/baz.git</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">baz_junior</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/foobar/baz</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">baz_the_third</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="troubleshooting">
<h2>排错<a class="headerlink" href="#troubleshooting" title="永久链接至标题">¶</a></h2>
<div class="section" id="incorrect-name-version">
<h3>错误的包名或版本<a class="headerlink" href="#incorrect-name-version" title="永久链接至标题">¶</a></h3>
<p>如果软件包看起来安装正确, 但salt报告了失败, 通常是因为版本号或 <code class="docutils literal"><span class="pre">full_name</span></code> 不匹配.</p>
<p>检查包的精确 <code class="docutils literal"><span class="pre">full_name</span></code> 和版本信息. 可以使用 <a href="#id1"><span class="problematic" id="id2">``</span></a>pkg.list_pkgs``来准确检查已安装的包名及版本号.</p>
</div>
<div class="section" id="changes-to-sls-files-not-being-picked-up">
<h3>sls文件的更改并没有获取到<a class="headerlink" href="#changes-to-sls-files-not-being-picked-up" title="永久链接至标题">¶</a></h3>
<p>Ensure you have (re)generated the repository cache file (for older minions) and
then updated the repository cache on the relevant minions:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>salt-run winrepo.genrepo
salt winminion pkg.refresh_db
</pre></div>
</div>
</div>
<div class="section" id="packages-management-under-windows-2003">
<h3>Windows 2003下的包管理<a class="headerlink" href="#packages-management-under-windows-2003" title="永久链接至标题">¶</a></h3>
<p>On Windows server 2003, you need to install optional Windows component &quot;wmi
windows installer provider&quot; to have full list of installed packages. If you
don't have this, salt-minion can't report some installed software.</p>
</div>
<div class="section" id="how-success-and-failure-are-reported">
<h3>How Success and Failure are Reported<a class="headerlink" href="#how-success-and-failure-are-reported" title="永久链接至标题">¶</a></h3>
<p>The install state/module function of the Windows package manager works roughly
as follows:</p>
<ol class="arabic simple">
<li><p class="first">执行 <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code> 并存储结果</p>
</li>
<li><p class="first">检查是否需要进行操作.(如和 <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code> 结果比对包及版本)</p>
</li>
<li><p class="first">如果需要, 运行installer命令.</p>
</li>
<li><p class="first">执行 <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code> 并与安装前比对已存储的结果.</p>
</li>
<li><p class="first">基于之前和最终的 <code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code> 比对结果, 报告安装成功/失败/变更.</p>
</li>
</ol>
<p>If there are any problems in using the package manager it is likely due to the
data in your sls files not matching the difference between the pre and post
<code class="docutils literal"><span class="pre">pkg.list_pkgs</span></code> results.</p>
</div>
</div>
</div>


                            </div>
                            <a href="index.html"><button data-container="body" data-toggle="tooltip" data-placement="bottom" title="Windows" id="prev-button" type="button" class="btn btn-secondary"><span class="glyphicon glyphicon-chevron-left"></span> Previous</button></a>
                            <a href="windows-specific-behavior.html"><button data-container="body" data-toggle="tooltip" data-placement="bottom" title="Windows-specific Behaviour" id="next-button" type="button" class="btn btn-primary">
                                Next <span class="glyphicon glyphicon-chevron-right"></span></button></a>
                        </div>
                    </div>
                    <div class="footer">
                        <hr />

                        
                    </div> <!--end footer-->

                    </div>
                </div>
            <!--start sidebar-->
            <div id="sidebar-wrapper">
            <div id="sidebar-static">

                <a class="ss-logo" href="http://saltstack.com"><img width="250" height="63" class="nolightbox sidebar-logo" src="../../_static/images/saltstack_logo.svg"></a>

                
                <div class="versions">
                    <p>Version 2016.3.0-172-gbf4b651</p>
                </div>
                

                <div id="search-form" class="inner-addon left-addon">
                    <i class="glyphicon glyphicon-search"></i>
                    <input type="text" class="form-control">
                </div>

            </div> <!--end sidebar-static-->

                <div id="sidebar-nav">
                    
                    
                    
                    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">SaltStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">安装教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuring Salt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_salt.html">Using Salt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../execution/index.html">Remote Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../states/index.html">Configuration Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event/index.html">Events &amp; Reactor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orchestrate/index.html">Orchestration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ssh/index.html">Salt SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/index.html">Salt云端</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proxyminion/index.html">Salt Proxy Minion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Salt Virt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ref/cli/index.html">Command Line Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ref/index.html">Salt Module Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology/index.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Windows</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Windows软件仓库</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#populate-the-repository">Populate the Repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sync-repo-to-windows-minions">Sync Repo to Windows Minions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#install-windows-software">安装Windows软件</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#show-installed-packages">Show Installed Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-a-package">Install a Package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#uninstall-windows-software">卸载Windows软件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#repository-location">Repository Location</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maintaining-windows-repo-definitions-in-git-repositories">Maintaining Windows Repo Definitions in Git Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-package-definition-sls-file">Creating a Package Definition SLS File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#managing-windows-software-on-a-standalone-windows-minion">Managing Windows Software on a Standalone Windows Minion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#custom-location-for-repository-sls-files">Custom Location for Repository SLS Files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#config-options-for-minions-2015-8-0-and-later">Config Options for Minions 2015.8.0 and Later</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-options-for-minions-before-2015-8-0">Config Options for Minions Before 2015.8.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changes-in-version-2015-8-0">Changes in Version 2015.8.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#config-parameters-renamed">Config Parameters Renamed</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#master-config">Master Config</a></li>
<li class="toctree-l5"><a class="reference internal" href="#minion-config">Minion Config</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#pygit2-gitpython-support-for-maintaining-git-repos">pygit2/GitPython Support for Maintaining Git Repos</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">排错</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#incorrect-name-version">错误的包名或版本</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changes-to-sls-files-not-being-picked-up">sls文件的更改并没有获取到</a></li>
<li class="toctree-l4"><a class="reference internal" href="#packages-management-under-windows-2003">Windows 2003下的包管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-success-and-failure-are-reported">How Success and Failure are Reported</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="windows-specific-behavior.html">Windows-specific Behaviour</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Salt开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
</ul>

                    
                    
                </div>

                <div id="sidebar-static-bottom">
                <div class="text-nowrap">
                    <!--social icons from http://vervex.deviantart.com/art/somacro-45-300dpi-social-media-icons-267955425-->
                    <ul id="social-links" class="list-inline">
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="watch saltstack videos on youtube" href="https://www.youtube.com/user/saltstack" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/youtube-variation.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="view the latest saltstack tweets" href="http://twitter.com/saltstackinc" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/twitter.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="subscribe to the salt users mailing list" href="https://groups.google.com/forum/#!forum/salt-users" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/email.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="download saltstack code from github" href="https://github.com/saltstack/salt" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/github.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="chat in #salt on freenode irc" href="http://webchat.freenode.net/?channels=salt&uio=mj10cnvljjk9dhj1zsyxmd10cnvl83" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/messenger-generic.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="/r/saltstack" href="http://www.reddit.com/r/saltstack/" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/reddit.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="ask a saltstack question on stackoverflow" href="http://stackoverflow.com/questions/tagged/salt-stack" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/stackoverflow.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="join or start a saltstack meetup" href="http://www.meetup.com/find/?keywords=saltstack" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/meetup.png" ></a></li>
                        <li><a data-container="body" data-delay='{ "show": 500, "hide": 100 }' data-toggle="tooltip" data-placement="top" title="follow saltstack on linkedin" href="http://www.linkedin.com/company/salt-stack-inc" target="_blank"><img class="nolightbox" width="24" src="../../_static/images/linkedin.png" ></a></li>
                    </ul>
                </div>
                </div>
            </div>
            <!--end sidebar-->

            </div> <!--end wrapper--> <!--end block content-->
        
    <script>
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../../',
            VERSION:     '2015.8.7',
            SEARCH_CX:   '004624818632696854117:yfmprrbw3pk',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  'true'
        };
    </script>

    <script src="../../_static/js/core.min.js"></script>

    <script src="../../_static/js/webhelp.min_v1.4.3.js"></script>

        
    </body>
</html>